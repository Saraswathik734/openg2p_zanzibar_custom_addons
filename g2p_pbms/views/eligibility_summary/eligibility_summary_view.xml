<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="view_g2p_eligibility_summary_wizard_form" model="ir.ui.view">
    <field name="name">g2p.eligibility.summary.wizard.form</field>
    <field name="model">g2p.eligibility.summary.wizard</field>
    <field name="arch" type="xml">
      <form string="Eligibility Summary">
        <sheet>
          <group>
            <field name="brief" readonly="1"/>
            <field name="program_id" readonly="1"/>
          </group>
          <notebook>
            <page string="Summary Details">
              <field name="summary_line_ids" mode="kanban">
                <kanban>
                  <templates>
                    <t t-name="kanban-box">
                      <t t-if="record.wizard_id.target_registry_type.raw_value == 'farmer'">
                        <div class="oe_kanban_card">
                          <strong t-esc="record.key.raw_value"/>
                          <br/>
                          <span t-esc="record.value.raw_value"/> (Farmer View)
                        </div>
                      </t>
                      <t t-if="record.wizard_id.target_registry_type.raw_value == 'student'">
                        <div class="oe_kanban_card">
                          <strong t-esc="record.key.raw_value"/>
                          <br/>
                          <span t-esc="record.value.raw_value"/> (Student View)
                        </div>
                      </t>
                      <t t-if="not (record.wizard_id.target_registry_type.raw_value in ['farmer', 'student'])">
                        <div class="oe_kanban_card">
                          <strong t-esc="record.key.raw_value"/>
                          <br/>
                          <span t-esc="record.value.raw_value"/>
                        </div>
                      </t>
                    </t>
                  </templates>
                </kanban>
                <tree create="false">
                  <field name="key"/>
                  <field name="value"/>
                </tree>
                <form create="false">
                  <group>
                    <field name="key"/>
                    <field name="value"/>
                  </group>
                </form>
              </field>
            </page>
            <page string="Beneficiaries">

              <group>
                <field name="target_registry_type" invisible="true"/>
                <field name="beneficiary_search" widget="domain"
                  options="{'model': 'g2p.farmer.registry', 'order': 'name asc'}"
                  invisible="target_registry_type != 'farmer'"/>
                      
                <!-- Domain widget for the Student type -->
                <field name="beneficiary_search" widget="domain"
                  options="{'model': 'g2p.student.registry'}"
                  invisible="target_registry_type != 'student'"/>

                
                <field name="sql_query"/>
              </group>
              <field name="eligibility_list_ids" mode="tree,form">
                <tree create="false">
                  <field name="beneficiary_id"/>
                  <field name="name"/>
                </tree>
                <form create="false">
                  <group>
                    <field name="beneficiary_id"/>
                    <field name="name"/>
                  </group>
                </form>
              </field>
            </page>
          </notebook>
        </sheet>
        <footer>
          <button string="Close" class="btn-secondary" special="cancel"/>
        </footer>
      </form>
    </field>
  </record>
</odoo>
